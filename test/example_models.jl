using sem, Test, Feather, BenchmarkTools, Distributions, Optim

### Modelle
function three_mean_func(x)
    S =[x[1] 0.0 0 0 0 0 0 0 0 0 0 0
        0 x[2] 0 0 0 0 0 0 0 0 0 0
        0 0 x[3] 0 0 0 0 0 0 0 0 0
        0 0 0 x[4] 0 0 0 0 0 0 0 0
        0 0 0 0 x[5] 0 0 0 0 0 0 0
        0 0 0 0 0 x[6] 0 0 0 0 0 0
        0 0 0 0 0 0 x[7] 0 0 0 0 0
        0 0 0 0 0 0 0 x[8] 0 0 0 0
        0 0 0 0 0 0 0 0 x[9] 0 0 0
        0 0 0 0 0 0 0 0 0 x[10] x[13] x[14]
        0 0 0 0 0 0 0 0 0 x[13] x[11] x[15]
        0 0 0 0 0 0 0 0 0 x[14] x[15] x[12]]

    F =[1.0 0 0 0 0 0 0 0 0 0 0 0
        0 1 0 0 0 0 0 0 0 0 0 0
        0 0 1 0 0 0 0 0 0 0 0 0
        0 0 0 1 0 0 0 0 0 0 0 0
        0 0 0 0 1 0 0 0 0 0 0 0
        0 0 0 0 0 1 0 0 0 0 0 0
        0 0 0 0 0 0 1 0 0 0 0 0
        0 0 0 0 0 0 0 1 0 0 0 0
        0 0 0 0 0 0 0 0 1 0 0 0]

    A =[0  0  0  0  0  0  0  0  0  1     0     0.0
        0  0  0  0  0  0  0  0  0  x[16] 0     0
        0  0  0  0  0  0  0  0  0  x[17] 0     0
        0  0  0  0  0  0  0  0  0  0     1     0
        0  0  0  0  0  0  0  0  0  0     x[18] 0
        0  0  0  0  0  0  0  0  0  0     x[19] 0
        0  0  0  0  0  0  0  0  0  0     0     1
        0  0  0  0  0  0  0  0  0  0     0     x[20]
        0  0  0  0  0  0  0  0  0  0     0     x[21]
        0  0  0  0  0  0  0  0  0  0     0     0
        0  0  0  0  0  0  0  0  0  0     0     0
        0  0  0  0  0  0  0  0  0  0     0     0]

    M = [0.5, 0.5, 0.5, 0.5, x[22], x[23], x[24], x[25], x[26], 0, 0, 0]

    return (S, F, A, M)
end

function three_path_func(x)

  S =[x[1]  0     0     0     0     0     0     0     0     0     0     0     0     0
      0     x[2]  0     0     0     0     0     0     0     0     0     0     0     0
      0     0     x[3]  0     0     0     0     0     0     0     0     0     0     0
      0     0     0     x[4]  0     0     0     x[15] 0     0     0     0     0     0
      0     0     0     0     x[5]  0     x[16] 0     x[17] 0     0     0     0     0
      0     0     0     0     0     x[6]  0     0     0     x[18] 0     0     0     0
      0     0     0     0     x[16] 0     x[7]  0     0     0     x[19] 0     0     0
      0     0     0     x[15] 0     0     0     x[8]  0     0     0     0     0     0
      0     0     0     0     x[17] 0     0     0     x[9]  0     x[20] 0     0     0
      0     0     0     0     0     x[18] 0     0     0     x[10] 0     0     0     0
      0     0     0     0     0     0     x[19] 0     x[20] 0     x[11] 0     0     0
      0     0     0     0     0     0     0     0     0     0     0     x[12] 0     0
      0     0     0     0     0     0     0     0     0     0     0     0     x[13] 0
      0     0     0     0     0     0     0     0     0     0     0     0     0     x[14]]

    F =[1 0 0 0 0 0 0 0 0 0 0 0 0 0
        0 1 0 0 0 0 0 0 0 0 0 0 0 0
        0 0 1 0 0 0 0 0 0 0 0 0 0 0
        0 0 0 1 0 0 0 0 0 0 0 0 0 0
        0 0 0 0 1 0 0 0 0 0 0 0 0 0
        0 0 0 0 0 1 0 0 0 0 0 0 0 0
        0 0 0 0 0 0 1 0 0 0 0 0 0 0
        0 0 0 0 0 0 0 1 0 0 0 0 0 0
        0 0 0 0 0 0 0 0 1 0 0 0 0 0
        0 0 0 0 0 0 0 0 0 1 0 0 0 0
        0 0 0 0 0 0 0 0 0 0 1 0 0 0]

  A =[0  0  0  0  0  0  0  0  0  0  0     1     0     0
      0  0  0  0  0  0  0  0  0  0  0     x[21] 0     0
      0  0  0  0  0  0  0  0  0  0  0     x[22] 0     0
      0  0  0  0  0  0  0  0  0  0  0     0     1     0
      0  0  0  0  0  0  0  0  0  0  0     0     x[23] 0
      0  0  0  0  0  0  0  0  0  0  0     0     x[24] 0
      0  0  0  0  0  0  0  0  0  0  0     0     x[25] 0
      0  0  0  0  0  0  0  0  0  0  0     0     0     1
      0  0  0  0  0  0  0  0  0  0  0     0     0     x[26]
      0  0  0  0  0  0  0  0  0  0  0     0     0     x[27]
      0  0  0  0  0  0  0  0  0  0  0     0     0     x[28]
      0  0  0  0  0  0  0  0  0  0  0     0     0     0
      0  0  0  0  0  0  0  0  0  0  0     x[29] 0     0
      0  0  0  0  0  0  0  0  0  0  0     x[30] x[31] 0]

    return (S, F, A)
end

function growth_func(x)

  S =[x[1]  0  0  0  0  0  0  0  0  0  0  0
      0  x[2]  0  0  0  0  0  0  0  0  0  0
      0  0  x[3]  0  0  0  0  0  0  0  0  0
      0  0  0  x[4]  0  0  0  0  0  0  0  0
      0  0  0  0  x[5]  0  0  0  0  0  0  0
      0  0  0  0  0  x[6]  0  0  0  0  0  0
      0  0  0  0  0  0  x[7]  0  0  0  0  0
      0  0  0  0  0  0  0  x[8]  0  0  0  0
      0  0  0  0  0  0  0  0  x[9]  0  0  0
      0  0  0  0  0  0  0  0  0  x[10]  0  0
      0  0  0  0  0  0  0  0  0  0  x[11]  x[13]
      0  0  0  0  0  0  0  0  0  0  x[13]  x[12]]


    F =[1 0 0 0 0 0 0 0 0 0 0 0
        0 1 0 0 0 0 0 0 0 0 0 0
        0 0 1 0 0 0 0 0 0 0 0 0
        0 0 0 1 0 0 0 0 0 0 0 0
        0 0 0 0 1 0 0 0 0 0 0 0
        0 0 0 0 0 1 0 0 0 0 0 0
        0 0 0 0 0 0 1 0 0 0 0 0
        0 0 0 0 0 0 0 1 0 0 0 0
        0 0 0 0 0 0 0 0 1 0 0 0
        0 0 0 0 0 0 0 0 0 1 0 0]

  A =[0  0  0  0  x[14] 0     0     0     0     0     1     0
      0  0  0  0  0     x[15] 0     0     0     0     1     1
      0  0  0  0  0     0     x[16] 0     0     0     1     2
      0  0  0  0  0     0     0     x[17] 0     0     1     3
      0  0  0  0  0     0     0     0     0     0     0     0
      0  0  0  0  0     0     0     0     0     0     0     0
      0  0  0  0  0     0     0     0     0     0     0     0
      0  0  0  0  0     0     0     0     0     0     0     0
      0  0  0  0  0     0     0     0     0     0     0     0
      0  0  0  0  0     0     0     0     0     0     0     0
      0  0  0  0  0     0     0     0     x[18] x[20] 0     0
      0  0  0  0  0     0     0     0     x[19] x[21] 0     0]

    return (S, F, A)
end
